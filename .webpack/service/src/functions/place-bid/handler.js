(()=>{var ie={979:(f,C,h)=>{/*!
 * depd
 * Copyright(c) 2014-2018 Douglas Christopher Wilson
 * MIT Licensed
 */var v=h(17).relative;f.exports=w;var T=process.cwd();function N(o,s){for(var p=o.split(/[ ,]+/),a=String(s).toLowerCase(),c=0;c<p.length;c++){var g=p[c];if(g&&(g==="*"||g.toLowerCase()===a))return!0}return!1}function k(o,s,p){var a=Object.getOwnPropertyDescriptor(o,s),c=a.value;return a.get=function(){return c},a.writable&&(a.set=function(R){return c=R}),delete a.value,delete a.writable,Object.defineProperty(o,s,a),a}function z(o){for(var s="",p=0;p<o;p++)s+=", arg"+p;return s.substr(2)}function S(o){var s=this.name+": "+this.namespace;this.message&&(s+=" deprecated "+this.message);for(var p=0;p<o.length;p++)s+=`
    at `+o[p].toString();return s}function w(o){if(!o)throw new TypeError("argument namespace is required");var s=d(),p=U(s[1]),a=p[0];function c(g){L.call(c,g)}return c._file=a,c._ignored=K(o),c._namespace=o,c._traced=J(o),c._warned=Object.create(null),c.function=b,c.property=P,c}function M(o,s){var p=typeof o.listenerCount!="function"?o.listeners(s).length:o.listenerCount(s);return p>0}function K(o){if(process.noDeprecation)return!0;var s=process.env.NO_DEPRECATION||"";return N(s,o)}function J(o){if(process.traceDeprecation)return!0;var s=process.env.TRACE_DEPRECATION||"";return N(s,o)}function L(o,s){var p=M(process,"deprecation");if(!(!p&&this._ignored)){var a,c,g,R,B=0,G=!1,H=d(),W=this._file;for(s?(R=s,g=U(H[1]),g.name=R.name,W=g[0]):(B=2,R=U(H[B]),g=R);B<H.length;B++)if(a=U(H[B]),c=a[0],c===W)G=!0;else if(c===this._file)W=this._file;else if(G)break;var Y=a?R.join(":")+"__"+a.join(":"):void 0;if(!(Y!==void 0&&Y in this._warned)){this._warned[Y]=!0;var $=o;if($||($=g===R||!g.name?X(R):X(g)),p){var oe=x(this._namespace,$,H.slice(B));process.emit("deprecation",oe);return}var Q=process.stderr.isTTY?y:V,q=Q.call(this,$,a,H.slice(B));process.stderr.write(q+`
`,"utf8")}}}function U(o){var s=o.getFileName()||"<anonymous>",p=o.getLineNumber(),a=o.getColumnNumber();o.isEval()&&(s=o.getEvalOrigin()+", "+s);var c=[s,p,a];return c.callSite=o,c.name=o.getFunctionName(),c}function X(o){var s=o.callSite,p=o.name;p||(p="<anonymous@"+A(o)+">");var a=s.getThis(),c=a&&s.getTypeName();return c==="Object"&&(c=void 0),c==="Function"&&(c=a.name||c),c&&s.getMethodName()?c+"."+p:p}function V(o,s,p){var a=new Date().toUTCString(),c=a+" "+this._namespace+" deprecated "+o;if(this._traced){for(var g=0;g<p.length;g++)c+=`
    at `+p[g].toString();return c}return s&&(c+=" at "+A(s)),c}function y(o,s,p){var a="\x1B[36;1m"+this._namespace+"\x1B[22;39m \x1B[33;1mdeprecated\x1B[22;39m \x1B[0m"+o+"\x1B[39m";if(this._traced){for(var c=0;c<p.length;c++)a+=`
    \x1B[36mat `+p[c].toString()+"\x1B[39m";return a}return s&&(a+=" \x1B[36m"+A(s)+"\x1B[39m"),a}function A(o){return v(T,o[0])+":"+o[1]+":"+o[2]}function d(){var o=Error.stackTraceLimit,s={},p=Error.prepareStackTrace;Error.prepareStackTrace=D,Error.stackTraceLimit=Math.max(10,o),Error.captureStackTrace(s);var a=s.stack.slice(1);return Error.prepareStackTrace=p,Error.stackTraceLimit=o,a}function D(o,s){return s}function b(o,s){if(typeof o!="function")throw new TypeError("argument fn must be a function");var p=z(o.length),a=d(),c=U(a[1]);c.name=o.name;var g=new Function("fn","log","deprecate","message","site",`"use strict"
return function (`+p+`) {log.call(deprecate, message, site)
return fn.apply(this, arguments)
}`)(o,L,this,s,c);return g}function P(o,s,p){if(!o||typeof o!="object"&&typeof o!="function")throw new TypeError("argument obj must be object");var a=Object.getOwnPropertyDescriptor(o,s);if(!a)throw new TypeError("must call property on owner object");if(!a.configurable)throw new TypeError("property must be configurable");var c=this,g=d(),R=U(g[1]);R.name=s,"value"in a&&(a=k(o,s,p));var B=a.get,G=a.set;typeof B=="function"&&(a.get=function(){return L.call(c,p,R),B.apply(this,arguments)}),typeof G=="function"&&(a.set=function(){return L.call(c,p,R),G.apply(this,arguments)}),Object.defineProperty(o,s,a)}function x(o,s,p){var a=new Error,c;return Object.defineProperty(a,"constructor",{value:x}),Object.defineProperty(a,"message",{configurable:!0,enumerable:!1,value:s,writable:!0}),Object.defineProperty(a,"name",{enumerable:!1,configurable:!0,value:"DeprecationError",writable:!0}),Object.defineProperty(a,"namespace",{configurable:!0,enumerable:!1,value:o,writable:!0}),Object.defineProperty(a,"stack",{configurable:!0,enumerable:!1,get:function(){return c!==void 0?c:c=S.call(this,p)},set:function(R){c=R}}),a}},390:(f,C,h)=>{"use strict";/*!
 * http-errors
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2016 Douglas Christopher Wilson
 * MIT Licensed
 */var v=h(979)("http-errors"),T=h(707),N=h(842),k=h(190),z=h(675);f.exports=w,f.exports.HttpError=M(),f.exports.isHttpError=J(f.exports.HttpError),X(f.exports,N.codes,f.exports.HttpError);function S(y){return Number(String(y).charAt(0)+"00")}function w(){for(var y,A,d=500,D={},b=0;b<arguments.length;b++){var P=arguments[b],x=typeof P;if(x==="object"&&P instanceof Error)y=P,d=y.status||y.statusCode||d;else if(x==="number"&&b===0)d=P;else if(x==="string")A=P;else if(x==="object")D=P;else throw new TypeError("argument #"+(b+1)+" unsupported type "+x)}typeof d=="number"&&(d<400||d>=600)&&v("non-error status code; use only 4xx or 5xx status codes"),(typeof d!="number"||!N.message[d]&&(d<400||d>=600))&&(d=500);var o=w[d]||w[S(d)];y||(y=o?new o(A):new Error(A||N.message[d]),Error.captureStackTrace(y,w)),(!o||!(y instanceof o)||y.status!==d)&&(y.expose=d<500,y.status=y.statusCode=d);for(var s in D)s!=="status"&&s!=="statusCode"&&(y[s]=D[s]);return y}function M(){function y(){throw new TypeError("cannot construct abstract class")}return k(y,Error),y}function K(y,A,d){var D=V(A);function b(P){var x=P??N.message[d],o=new Error(x);return Error.captureStackTrace(o,b),T(o,b.prototype),Object.defineProperty(o,"message",{enumerable:!0,configurable:!0,value:x,writable:!0}),Object.defineProperty(o,"name",{enumerable:!1,configurable:!0,value:D,writable:!0}),o}return k(b,y),U(b,D),b.prototype.status=d,b.prototype.statusCode=d,b.prototype.expose=!0,b}function J(y){return function(d){return!d||typeof d!="object"?!1:d instanceof y?!0:d instanceof Error&&typeof d.expose=="boolean"&&typeof d.statusCode=="number"&&d.status===d.statusCode}}function L(y,A,d){var D=V(A);function b(P){var x=P??N.message[d],o=new Error(x);return Error.captureStackTrace(o,b),T(o,b.prototype),Object.defineProperty(o,"message",{enumerable:!0,configurable:!0,value:x,writable:!0}),Object.defineProperty(o,"name",{enumerable:!1,configurable:!0,value:D,writable:!0}),o}return k(b,y),U(b,D),b.prototype.status=d,b.prototype.statusCode=d,b.prototype.expose=!1,b}function U(y,A){var d=Object.getOwnPropertyDescriptor(y,"name");d&&d.configurable&&(d.value=A,Object.defineProperty(y,"name",d))}function X(y,A,d){A.forEach(function(b){var P,x=z(N.message[b]);switch(S(b)){case 400:P=K(d,x,b);break;case 500:P=L(d,x,b);break}P&&(y[b]=P,y[x]=P)})}function V(y){return y.substr(-5)!=="Error"?y+"Error":y}},190:(f,C,h)=>{try{var v=h(837);if(typeof v.inherits!="function")throw"";f.exports=v.inherits}catch{f.exports=h(480)}},480:f=>{typeof Object.create=="function"?f.exports=function(h,v){v&&(h.super_=v,h.prototype=Object.create(v.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}))}:f.exports=function(h,v){if(v){h.super_=v;var T=function(){};T.prototype=v.prototype,h.prototype=new T,h.prototype.constructor=h}}},707:f=>{"use strict";f.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?C:h);function C(v,T){return v.__proto__=T,v}function h(v,T){for(var N in T)Object.prototype.hasOwnProperty.call(v,N)||(v[N]=T[N]);return v}},842:(f,C,h)=>{"use strict";/*!
 * statuses
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2016 Douglas Christopher Wilson
 * MIT Licensed
 */var v=h(371);f.exports=S,S.message=v,S.code=T(v),S.codes=N(v),S.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},S.empty={204:!0,205:!0,304:!0},S.retry={502:!0,503:!0,504:!0};function T(w){var M={};return Object.keys(w).forEach(function(J){var L=w[J],U=Number(J);M[L.toLowerCase()]=U}),M}function N(w){return Object.keys(w).map(function(K){return Number(K)})}function k(w){var M=w.toLowerCase();if(!Object.prototype.hasOwnProperty.call(S.code,M))throw new Error('invalid status message: "'+w+'"');return S.code[M]}function z(w){if(!Object.prototype.hasOwnProperty.call(S.message,w))throw new Error("invalid status code: "+w);return S.message[w]}function S(w){if(typeof w=="number")return z(w);if(typeof w!="string")throw new TypeError("code must be a number or string");var M=parseInt(w,10);return isNaN(M)?k(w):z(M)}},675:f=>{"use strict";/*!
 * toidentifier
 * Copyright(c) 2016 Douglas Christopher Wilson
 * MIT Licensed
 */f.exports=C;function C(h){return h.split(" ").map(function(v){return v.slice(0,1).toUpperCase()+v.slice(1)}).join("").replace(/[^ _0-9a-z]/gi,"")}},17:f=>{"use strict";f.exports=require("path")},837:f=>{"use strict";f.exports=require("util")},371:f=>{"use strict";f.exports=JSON.parse(`{"100":"Continue","101":"Switching Protocols","102":"Processing","103":"Early Hints","200":"OK","201":"Created","202":"Accepted","203":"Non-Authoritative Information","204":"No Content","205":"Reset Content","206":"Partial Content","207":"Multi-Status","208":"Already Reported","226":"IM Used","300":"Multiple Choices","301":"Moved Permanently","302":"Found","303":"See Other","304":"Not Modified","305":"Use Proxy","307":"Temporary Redirect","308":"Permanent Redirect","400":"Bad Request","401":"Unauthorized","402":"Payment Required","403":"Forbidden","404":"Not Found","405":"Method Not Allowed","406":"Not Acceptable","407":"Proxy Authentication Required","408":"Request Timeout","409":"Conflict","410":"Gone","411":"Length Required","412":"Precondition Failed","413":"Payload Too Large","414":"URI Too Long","415":"Unsupported Media Type","416":"Range Not Satisfiable","417":"Expectation Failed","418":"I'm a Teapot","421":"Misdirected Request","422":"Unprocessable Entity","423":"Locked","424":"Failed Dependency","425":"Too Early","426":"Upgrade Required","428":"Precondition Required","429":"Too Many Requests","431":"Request Header Fields Too Large","451":"Unavailable For Legal Reasons","500":"Internal Server Error","501":"Not Implemented","502":"Bad Gateway","503":"Service Unavailable","504":"Gateway Timeout","505":"HTTP Version Not Supported","506":"Variant Also Negotiates","507":"Insufficient Storage","508":"Loop Detected","509":"Bandwidth Limit Exceeded","510":"Not Extended","511":"Network Authentication Required"}`)}},te={};function I(f){var C=te[f];if(C!==void 0)return C.exports;var h=te[f]={exports:{}};return ie[f](h,h.exports,I),h.exports}I.n=f=>{var C=f&&f.__esModule?()=>f.default:()=>f;return I.d(C,{a:C}),C},I.d=(f,C)=>{for(var h in C)I.o(C,h)&&!I.o(f,h)&&Object.defineProperty(f,h,{enumerable:!0,get:C[h]})},I.o=(f,C)=>Object.prototype.hasOwnProperty.call(f,C),I.r=f=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})};var Z={};(()=>{"use strict";I.r(Z),I.d(Z,{main:()=>Pe});const f=()=>({before:async t=>{console.log("Logging event....."),console.log(t)}}),C=require("events"),h=()=>{},v={timeoutEarlyInMillis:5,timeoutEarlyResponse:()=>{throw new Error("Timeout")}},T=(e=h,t={})=>{var m;typeof e!="function"&&(t=e,e=h),t={...v,...t},t.timeoutEarly=t.timeoutEarlyInMillis>0,(m=t.beforePrefetch)==null||m.call(t);const r=[],n=[],l=[],i=(u={},E={})=>{var j;(j=t.requestStart)==null||j.call(t);const _={event:u,context:E,response:void 0,error:void 0,internal:t.internal??{}};return N(_,[...r],e,[...n],[...l],t)};return i.use=u=>{Array.isArray(u)||(u=[u]);for(const E of u){const{before:_,after:j,onError:O}=E;if(!_&&!j&&!O)throw new Error('Middleware must be an object containing at least one key among "before", "after", "onError"');_&&i.before(_),j&&i.after(j),O&&i.onError(O)}return i},i.before=u=>(r.push(u),i),i.after=u=>(n.unshift(u),i),i.onError=u=>(l.unshift(u),i),i.handler=u=>(e=u,i),i},N=async(e,t,r,n,l,i)=>{var u,E,_;const m=i.timeoutEarly&&e.context.getRemainingTimeInMillis;try{if(await k(e,t,i),typeof e.response>"u"){(u=i.beforeHandler)==null||u.call(i);const j=new AbortController;let O;m&&(O=new AbortController),e.response=await Promise.race([r(e.event,e.context,{signal:j.signal}),m?w(e.context.getRemainingTimeInMillis()-i.timeoutEarlyInMillis,{signal:O.signal}).then(()=>(j.abort(),i.timeoutEarlyResponse())):Promise.race([])]),m&&O.abort(),(E=i.afterHandler)==null||E.call(i),await k(e,n,i)}}catch(j){e.response=void 0,e.error=j;try{await k(e,l,i)}catch(O){throw O.originalError=e.error,e.error=O,e.error}if(typeof e.response>"u")throw e.error}finally{await((_=i.requestEnd)==null?void 0:_.call(i,e))}return e.response},k=async(e,t,r)=>{var n,l;for(const i of t){(n=r.beforeMiddleware)==null||n.call(r,i.name);const m=await i(e);if((l=r.afterMiddleware)==null||l.call(r,i.name),typeof m<"u"){e.response=m;return}}},z=()=>{if(process.version<"v15.0.0"){class e{toString(){return"[object AbortSignal]"}get[Symbol.toStringTag](){return"AbortSignal"}removeEventListener(r,n){this.eventEmitter.removeListener(r,n)}addEventListener(r,n){this.eventEmitter.on(r,n)}dispatchEvent(r){const n={type:r,target:this},l=`on${r}`;typeof this[l]=="function"&&this[l](n),this.eventEmitter.emit(r,n)}constructor(){this.eventEmitter=new C.EventEmitter,this.onabort=null,this.aborted=!1}}return class{abort(){this.signal.aborted||(this.signal.aborted=!0,this.signal.dispatchEvent("abort"))}toString(){return"[object AbortController]"}get[Symbol.toStringTag](){return"AbortController"}constructor(){this.signal=new e}}}else return AbortController};global.AbortController=z();const w=(()=>(e,{signal:t})=>t.aborted?Promise.reject(new Error("Aborted","AbortError")):new Promise((r,n)=>{const l=()=>{clearTimeout(i),n(new Error("Aborted","AbortError"))},i=setTimeout(()=>{r(),t.removeEventListener("abort",l)},e);t.addEventListener("abort",l)}))(),M=T,K=require("aws-sdk");var J=I.n(K);const L={AuctionsTableNames:process.env.AUCTIONS_TABLE_NAME},U={Open:"Open",Close:"Close"},V=(async()=>{const e=new(J()).DynamoDB.DocumentClient;return{createAuction:async t=>(await e.put({TableName:L.AuctionsTableNames,Item:t}).promise()).Attributes,getAllAuctions:async()=>(await e.scan({TableName:L.AuctionsTableNames}).promise()).Items,getAuctionById:async t=>{const r=await e.get({TableName:L.AuctionsTableNames,Key:{id:t}}).promise();return r==null?void 0:r.Item},placeBid:async(t,r)=>{const n={TableName:L.AuctionsTableNames,Key:{id:t},UpdateExpression:"set highestBid.amount = :amount",ReturnValues:"ALL_NEW",ConditionExpression:"highestBid.amount < :amount",ExpressionAttributeValues:{":amount":r}},l=await e.update(n).promise();return l==null?void 0:l.Attributes},getEndedAuctions:async()=>{const t=new Date,r={TableName:L.AuctionsTableNames,IndexName:"statusAndEndDate",KeyConditionExpression:"#status = :status AND endingAt <= :now",ExpressionAttributeValues:{":status":U.Open,":now":t.toISOString()},ExpressionAttributeNames:{"#status":"status"}};return(await e.query(r).promise()).Items}}})();var y=I(390),A=I.n(y);const d=e=>{const{awsClientOptions:t}=e,r=new e.AwsClient(t);return e.awsClientCapture&&e.disablePrefetch?e.awsClientCapture(r):(e.awsClientCapture&&console.warn("Unable to apply X-Ray outside of handler invocation scope."),r)},D=async(e,t)=>{let r={};if(e.awsClientAssumeRole){if(!t)throw new Error("Request required when assuming role");r=await P({credentials:e.awsClientAssumeRole},t)}return r={...r,...e.awsClientOptions},d({...e,awsClientOptions:r})},b=(e={})=>!e.awsClientAssumeRole&&!e.disablePrefetch,P=async(e,t)=>{if(!e||!t)return{};let r=[],n=[];e===!0?r=n=Object.keys(t.internal):typeof e=="string"?r=n=[e]:Array.isArray(e)?r=n=e:typeof e=="object"&&(r=Object.keys(e),n=Object.values(e));const l=[];for(const m of n){const u=m.split("."),E=u.shift();let _=t.internal[E];x(_)||(_=Promise.resolve(_)),l.push(_.then(j=>u.reduce((O,ee)=>O==null?void 0:O[ee],j)))}n=await Promise.allSettled(l);const i=n.filter(m=>m.status==="rejected").map(m=>m.reason);if(i.length)throw new Error("Failed to resolve internal values",{cause:i});return r.reduce((m,u,E)=>({...m,[p(u)]:n[E].value}),{})},x=e=>typeof(e==null?void 0:e.then)=="function",o=/^([0-9])/,s=/[^a-zA-Z0-9]+/g,p=e=>e.replace(o,"_$1").replace(s,"_"),a={},c=(e,t=()=>{},r)=>{const{cacheExpiry:n,cacheKey:l}=e;if(n){const u=g(l),E=u.expiry&&(n<0||u.expiry>Date.now());if(E&&u.modified){const _=t(r,u.value);return a[l]=Object.create({value:{...u.value,..._},expiry:u.expiry}),a[l]}if(E)return{...u,cache:!0}}const i=t(r),m=Date.now()+n;if(n){const u=n>0?setInterval(()=>c(e,t,r),n):void 0;a[l]={value:i,expiry:m,refresh:u}}return{value:i,expiry:m}},g=e=>a[e]?a[e]:{},R=(e,t)=>{var r;a[e]&&(clearInterval((r=a[e])==null?void 0:r.refresh),a[e]={...a[e],value:t,modified:!0})},B=(e=null)=>{var t;e=e??Object.keys(a),Array.isArray(e)||(e=[e]);for(const r of e)clearInterval((t=a[r])==null?void 0:t.refresh),a[r]=void 0},G=(e,t)=>{if(typeof e!="string")return e;const r=e[0];if(r!=="{"&&r!=="["&&r!=='"')return e;try{return JSON.parse(e,t)}catch{}return e},H=(e,t,r)=>{try{return JSON.stringify(e,t,r)}catch{}return e},W=e=>{let{response:t}=e;return typeof t>"u"?t={}:typeof(t==null?void 0:t.statusCode)>"u"&&typeof(t==null?void 0:t.body)>"u"&&typeof(t==null?void 0:t.headers)>"u"&&(t={statusCode:200,body:t}),t.statusCode??(t.statusCode=500),t.headers??(t.headers={}),e.response=t,t},Y=/[^a-zA-Z]/g;class $ extends null{constructor(t,r,n={}){r&&typeof r!="string"&&(n=r,r=void 0),r??(r=Q[t]),super(r,n);const l=Q[t].replace(Y,"");this.name=l.substr(-5)!=="Error"?l+"Error":l,this.status=this.statusCode=t,this.expose=n.expose??t<500}}const oe=(e,t,r={})=>new $(e,t,r),Q={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},q={logger:console.error,fallbackMessage:null},ce=(e={})=>{const t={...q,...e};return{onError:async n=>{if(n.response===void 0&&(typeof t.logger=="function"&&t.logger(n.error),n.error.statusCode&&n.error.expose===void 0&&(n.error.expose=n.error.statusCode<500),t.fallbackMessage&&(!n.error.statusCode||!n.error.expose)&&(n.error={statusCode:500,message:t.fallbackMessage,expose:!0}),n.error.expose)){W(n);const{statusCode:l,message:i,headers:m}=n.error;n.response={...n.response,statusCode:l,body:i,headers:{...m,...n.response.headers,"Content-Type":typeof G(i)=="string"?"text/plain":"application/json"}}}}}},ue=require("https");var ae;const le={httpOptions:{agent:new ue.Agent({keepAlive:!0,secureProtocol:"TLSv1_2_method"})}},de=e=>{const t={...le,...e.awsClientOptions},r=new e.AwsClient(t);return e.awsClientCapture&&e.disablePrefetch?e.awsClientCapture(r):(e.awsClientCapture&&console.warn("Unable to apply X-Ray outside of handler invocation scope."),r)},Ae=async(e,t)=>{let r={};if(e.awsClientAssumeRole){if(!t)throw new Error("Request required when assuming role");r=await fe({credentials:e.awsClientAssumeRole},t)}return r={...r,...e.awsClientOptions},de({...e,awsClientOptions:r})},Oe=(e={})=>!e.awsClientAssumeRole&&!e.disablePrefetch,fe=async(e,t)=>{if(!e||!t)return{};let r=[],n=[];e===!0?r=n=Object.keys(t.internal):typeof e=="string"?r=n=[e]:Array.isArray(e)?r=n=e:typeof e=="object"&&(r=Object.keys(e),n=Object.values(e));const l=[];for(const m of n){const u=m.split("."),E=u.shift();let _=t.internal[E];pe(_)||(_=Promise.resolve(_)),l.push(_.then(j=>u.reduce((O,ee)=>O==null?void 0:O[ee],j)))}n=await Promise.allSettled(l);const i=n.filter(m=>m.status==="rejected").map(m=>m.reason);if(i.length){const m=new Error("Failed to resolve internal values");throw m.cause=i,m}return r.reduce((m,u,E)=>({...m,[he(u)]:n[E].value}),{})},pe=e=>typeof(e==null?void 0:e.then)=="function",ye=/^([0-9])/,me=/[^a-zA-Z0-9]+/g,he=e=>e.replace(ye,"_$1").replace(me,"_"),F={},Te=(e,t=()=>{},r)=>{const{cacheExpiry:n,cacheKey:l}=e;if(n){const u=be(l),E=u.expiry&&(n<0||u.expiry>Date.now());if(E&&u.modified){const _=t(r,u.value);return F[l]={value:{...u.value,..._},expiry:u.expiry},F[l]}if(E)return{...u,cache:!0}}const i=t(r),m=Date.now()+n;if(n){const u=n>0?setInterval(()=>{const E=t(r),_=Date.now()+n;Object.assign(F[l],{value:E,expiry:_})},n):void 0;F[l]={value:i,expiry:m,refresh:u}}return{value:i,expiry:m}},be=e=>F[e]?F[e]:{},Ne=(e,t)=>{var r;F[e]&&(clearInterval((r=F[e])==null?void 0:r.refresh),F[e]={...F[e],value:t,modified:!0})},Se=(e=null)=>{var t;e=e??Object.keys(F),Array.isArray(e)||(e=[e]);for(const r of e)clearInterval((t=F[r])==null?void 0:t.refresh),F[r]=void 0},Re=(e,t)=>{if(typeof e!="string")return e;const r=e[0];if(r!=="{"&&r!=="["&&r!=='"')return e;try{return JSON.parse(e,t)}catch{}return e},Me=(e,t,r)=>{try{return JSON.stringify(e,t,r)}catch{}return e},je=e=>{let{response:t}=e;return typeof t>"u"?t={}:typeof(t==null?void 0:t.statusCode)>"u"&&typeof(t==null?void 0:t.body)>"u"&&typeof(t==null?void 0:t.headers)>"u"&&(t={body:t}),(ae=t).headers??(ae.headers={}),e.response=t,t},ve=/[^a-zA-Z]/g;class we extends Error{constructor(t,r,n={}){r&&typeof r!="string"&&(n=r,r=void 0),r??(r=se[t]),super(r),this.cause=n.cause;const l=se[t].replace(ve,"");this.name=l.substr(-5)!=="Error"?l+"Error":l,this.status=this.statusCode=t,this.expose=n.expose??t<500}}const ge=(e,t,r={})=>new we(e,t,r),se={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},Ee=/^application\/(.+\+)?json(;.*)?$/,Ce={reviver:void 0},_e=(e={})=>{const{reviver:t}={...Ce,...e};return{before:async n=>{const{headers:l,body:i}=n.event,m=l["Content-Type"]??l["content-type"];if(Ee.test(m))try{const u=n.event.isBase64Encoded?Buffer.from(i,"base64").toString():i;n.event.rawBody=i,n.event.body=JSON.parse(u,t)}catch(u){const E=ge(422,"Invalid or malformed JSON was provided");throw E.cause=u,E}}}},Pe=M(async e=>{const{id:t}=e.pathParameters,{amount:r}=e.body,n=await V;console.log(r,t);const l=await n.placeBid(t,r);if(!l)throw new(A()).NotFound(`Auction with id:"${t}" not found`);return{statusCode:200,body:JSON.stringify({updatedAuction:l,id:t})}}).use(f()).use(_e()).use(ce())})();var re=exports;for(var ne in Z)re[ne]=Z[ne];Z.__esModule&&Object.defineProperty(re,"__esModule",{value:!0})})();

//# sourceMappingURL=handler.js.map